--Retrieve a list of all films, including their title, release year, and rental rate--

select film_id, title, release_year, rental_rate from film

--Display all customers’ first name, last name, and email, sorted alphabetically by last name--

select first_name, last_name, email from customer
order by last_name desc

--List all distinct film categories available in the database.--

select distinct(category.name) from category
join film_category 
on category.category_id = film_category.category_id
group by category.name
order by category.name

--Show all films with a rental duration greater than 5 days--

select film_id, title, rental_duration from film
where rental_duration>5
order by rental_duration

--Retrieve all actors whose last name starts with ‘S’--

select first_name, last_name from actor
where last_name like 'S%'

--Find the total number of films available in each category--

select category.name, count(film_category.film_id) from category 
join film_category
on category.category_id = film_category.category_id
group by category.name

--Display the top 10 most rented films, ordered by number of rentals--
--Which films are rented the most--

select f.title, count(r.rental_id) from film f
join inventory i
on f.film_id = i.film_id
join rental r
on r.inventory_id = i.inventory_id
group by f.title
order by count(r.rental_id) desc
limit 10

--Show the total number of rentals made by each customer, including customer name--

select c.first_name, c.last_name, count(r.rental_id) from customer c
join rental r
on c.customer_id = r.customer_id
group by c.first_name, c.last_name
order by count(r.rental_id) desc

--Which films have the most copies in stock--

select f.film_id, f.title,count(i.inventory_id) from film f
join inventory i
on f.film_id = i.film_id
group by f.title, f.film_id
order by count(i.inventory_id) desc

--Calculate the total revenue generated by each store with store address
select s.store_id, c.city, co.country, sum(p.amount) from store s
JOIN staff st ON s.store_id = st.store_id
JOIN payment p ON st.staff_id = p.staff_id
JOIN address a ON s.address_id = a.address_id
JOIN city c ON a.city_id = c.city_id
JOIN country co ON c.country_id = co.country_id
group by s.store_id, c.city, co.country
order by sum(p.amount)

--Retrieve the average rental rate per film category--

Select AVG(f.rental_rate), c.name from film f
join film_category fc on fc.film_id = f.film_id 
join category c on c.category_id = fc.category_id
group by c.name
order by AVG(f.rental_rate) desc

--Identify the customers who have rented more films than the average customer--

select c.customer_id, c.first_name, c.last_name,count(r.rental_id), Avg(r.rental_id) from customer c
join rental r on c.customer_id = r.customer_id
group by c.customer_id, c.first_name, c.last_name
having count(r.rental_id) 
order by count(r.rental_id) desc

